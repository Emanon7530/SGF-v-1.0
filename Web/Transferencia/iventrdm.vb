
' Generated by MyGeneration Version # (1.2.0.7)

Public Class iventrdm 
	Inherits _iventrdm

    Public Function CreateFromRowSalida(ByVal oRow As DataRow) As Integer
        Dim intProvCode As Integer
        Dim intEntrSerial As Integer
        Dim intSucCode As Integer

        Try

            Me.Where.Prov_code.Value = oRow!cust_code
            Me.Where.Entr_number.Value = oRow!doc_number

            Me.Query.Load()

            If Me.RowCount <= 0 Then
                Me.AddNew()
            End If

            intProvCode = System.Configuration.ConfigurationSettings.AppSettings.Get("LibxProvCode")
            intSucCode = System.Configuration.ConfigurationSettings.AppSettings.Get("LibxScDefault")

            If intProvCode = -1 Then
                Throw New ApplicationException("No se ha especificado el proveedor en el config file!")
            End If

            Me.Entr_number = oRow!doc_number
            Me.Entr_date = oRow!doc_date
            Me.Prov_code = intProvCode
            Me.Type_code = "CRD"
            Me.Whse_code = oRow!whse_code
            Me.Term_code = oRow!term_code
            Me.Total_amount = oRow!total_amount
            Me.Itbis_amount = oRow!itbis_amount
            Me.Entr_status = 2 '// Pendiente
            Me.Date_created = DateTime.Now
            Me.Suc_code = intSucCode
            '// Me.Userid = LibX.User.UserID

            '// Save
            Me.Save()

            intEntrSerial = Me.Entr_serial

            Return intEntrSerial
        Catch ex As Exception

            Throw
        End Try

    End Function
End Class
